{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "params": [
    {
      "name": "Current_State",
      "value": "Johor",
      "bind": {
        "input": "select",
        "options": [
          "Johor",
          "Kedah",
          "Kelantan",
          "Kuala Lumpur",
          "Melaka",
          "Negeri Sembilan",
          "Pahang",
          "Penang",
          "Perak",
          "Perlis",
          "Sabah",
          "Sarawak",
          "Selangor",
          "Terengganu"
        ],
        "name": "States: "
      }
    },
    {
      "name": "Current_Year",
      "value": 2017,
      "bind": {
        "input": "range",
        "min": 2017,
        "max": 2019,
        "step": 1,
        "name": "Year: "
      }
    }
  ],
  "data": { "url": "https://cheryl-neoh.github.io/FIT3179/Assignment 2/Data/Age, Gender and state of drug addicts.csv"},
  "transform": [
    {"filter": "datum.id == Current_State"},
    {"filter": "datum.Year == Current_Year"},
    {"calculate": "datum.Gender == 'P' ? 'Female' : 'Male'", "as": "gender"}
  ],
  "spacing": 10,
  "hconcat": [
    {
      "width":250,
      "height": 300,
      "selection":{
        "highlight": {"type": "single", "empty": "none", "on": "mouseover"}
      },
      "transform": [
        {
        "filter": {"field": "gender", "equal": "Female"}
        }
      ],
      "title": "Female",
      "mark": {"type":"bar", "stroke": "black"},
      "encoding": {
        "y": {
          "field": "Age", 
          "axis": null, 
          "sort": "descending"
        },
        "x": {
          "aggregate": "sum", "field": "Number of Drug addicts",
          "title": "Number of Drug addicts",
          "axis": {"format": "s"},
          "sort": "descending"
        },
        "color": {
          "field": "gender",
          "scale": {"range": ["#c1bbdd", "#c1e7e3"]},
          "legend": null
        },
        "strokeOpacity":{
          "condition":[
            {
              "selection":"highlight", "value": 1
            }
          ], "value": 0.2
        },
        "tooltip":[
          {"field":"gender", "type": "nominal"},
          {"field":"Age", "type": "ordinal"},
          {"field":"Number of Drug addicts", "type": "quantitative"}
        ]
      }
    }, 
    {
      "width": 20,
      "height": 300,
      "view": {"stroke": null},
      "mark": {
        "type": "text",
        "align": "center"
      },
      "encoding": {
        "y": {"field": "Age", "type": "ordinal", "axis": null, "sort": "descending"},
        "text": {"field": "Age", "type": "ordinal"}
      }
    }, 
    {
      "width": 250,
      "height": 300,
      "selection":{
        "highlight": {"type": "single", "empty": "none", "on": "mouseover"}
      },
      "transform": [{
        "filter": {"field": "gender", "equal": "Male"}
      }],
      "title": "Male",
      "mark": {"type":"bar", "stroke": "black"},
      "encoding": {
        "y": {
          "field": "Age", "title": null,
          "axis": null, "sort": "descending"
        },
        "x": {
          "aggregate": "sum", "field": "Number of Drug addicts",
          "title": "Number of Drug addicts",
          "axis": {"format": "s"}
        },
        "color": {
          "field": "gender",
          "legend": null
        },
        "strokeOpacity":{
          "condition":[
            {
              "selection":"highlight", "value": 1
            }
          ], "value": 0.2
        },
        "tooltip":[
          {"field":"gender", "type": "nominal"},
          {"field":"Age", "type": "ordinal"},
          {"field":"Number of Drug addicts", "type": "quantitative"}
        ]
      }
    }
  ],
  "config": {
    "view": {"stroke": null},
    "axis": {"grid": false},
    "background": "snow"
  }
}
