{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "params": [
    {
      "name": "Current_Year",
      "value": 2017,
      "bind": {
        "input": "range",
        "min": 2017,
        "max": 2019,
        "step": 1,
        "name": "Year: "
      }
    }
  ],
  "data": {
    "url": "https://cheryl-neoh.github.io/FIT3179/Assignment 2/Data/Education-level of Drug addicts.csv"
  },
  "layer":[
    {
      "transform": [
        {"filter": "datum.Year == Current_Year"}
      ],
      "mark": {"type": "arc", "radius": 100, "radius2": 70, "cornerRadius":5, "padAngle":0.02},
      "encoding": {
        "theta": {"field": "Number of drug addicts", "type": "quantitative"},
        "color": {"field": "Education level", "type": "nominal", "legend":null},
        "tooltip": [
          {"field": "Education level", "type": "nominal"},
          {"field": "Number of drug addicts", "type": "quantitative"}
        ]
      }
    },
    {
      "transform": [
        {
          "lookup": "Year",
           "from":{
              "data":{
                "values" :[
                  {"Year": 2017, "title": "Total of"},
                  {"Year": 2018, "title": "Total of"},
                  {"Year": 2019, "title": "Total of"}
                ]
              },
              "key": "Year",
              "fields": ["title"]
           }
        }
      ],
      "mark": {"type":"text", "size":15, "dy":-20, "color":"#34282C"},
      "encoding": {
        "text": { "field": "title" }
      }
    },
    {
        "transform": [
        {"filter": "datum.Year == Current_Year"},
        {
          "joinaggregate": [
            {
            "op": "sum",
            "field": "Number of drug addicts",
            "as": "Total"
            }
          ]
        }
      ],
      "mark": {"type":"text", "size":20, "dy":0, "color":"#34282C"},
      "encoding": {
        "text": { "field": "Total" }
      }
    },
    {
        "transform": [
        {
          "lookup": "Year",
           "from":{
              "data":{
                "values" :[
                  {"Year": 2017, "title2": "Drug addicts"},
                  {"Year": 2018, "title2": "Drug addicts"},
                  {"Year": 2019, "title2": "Drug addicts"}
                ]
              },
              "key": "Year",
              "fields": ["title2"]
           }
        }
      ],
      "mark": {"type":"text", "size":15, "dy":20, "color":"#34282C"},
      "encoding": {
        "text": { "field": "title2" }
      }
    }
  ],
  "view": {"stroke": null}
}
